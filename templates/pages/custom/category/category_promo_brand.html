---
products:
    featured:
        limit: {{theme_settings.homepage_featured_products_count}}
carousel: {{theme_settings.homepage_show_carousel}}
---

{{#partial "no-container"}}


    <div class="carousel-container">
        <div class="cat-promo-img">
            <picture>
                <source media="(min-width: 1261px)" srcset="/product_images/uploaded_images/{{first (split (first (split (last (split (stripQuerystring (getImage category.image)) "/")) ".")) "_")}}-l.jpg">
                <source media="(min-width: 801px)" srcset="/product_images/uploaded_images/{{first (split (first (split (last (split (stripQuerystring (getImage category.image)) "/")) ".")) "_")}}-m.jpg">
                <img src="/product_images/uploaded_images/{{first (split (first (split (last (split (stripQuerystring (getImage category.image)) "/")) ".")) "_")}}-s.jpg" alt="{{category.image.alt}} Category Image">
            </picture> 
        </div>
    </div>
    <div class="container">
        {{{region name="category_bottom_of_header"}}}
    </div>
    <div class="block-grey-lt">
        <div class="container">
            {{{region name="category_below_header_grey"}}}
        </div>
    </div>


    <div class="block">
        <div class="container page">

            {{assignVar "totalCount" 0}}
            {{assignVar "currentIndex" 0}}
            {{> components/faceted-search/total-brands category template=template}}

            <main id="product-listing-container">
                <!-- A for loop doesn't allow access to the context of the page, so given we know the soft limitation of only 5-6 product types, it's just a 'manual loop' -->
                {{#if (getVar "currentIndex") "<" (getVar "totalCount")}}
                    {{> components/faceted-search/output-brand category template=template}}
                    {{> components/products/promo-products-brand products=category.products}}
                {{/if}}
                {{#if (getVar "currentIndex") "<" (getVar "totalCount")}}
                    {{> components/faceted-search/output-brand category template=template}}
                    {{> components/products/promo-products-brand products=category.products}}
                {{/if}}            
                {{#if (getVar "currentIndex") "<" (getVar "totalCount")}}
                    {{> components/faceted-search/output-brand category template=template}}
                    {{> components/products/promo-products-brand products=category.products}}
                {{/if}}
                {{#if (getVar "currentIndex") "<" (getVar "totalCount")}}
                    {{> components/faceted-search/output-brand category template=template}}
                    {{> components/products/promo-products-brand products=category.products}}
                {{/if}}
                {{#if (getVar "currentIndex") "<" (getVar "totalCount")}}
                    {{> components/faceted-search/output-brand category template=template}}
                    {{> components/products/promo-products-brand products=category.products}}
                {{/if}}
                {{#if (getVar "currentIndex") "<" (getVar "totalCount")}}
                    {{> components/faceted-search/output-brand category template=template}}
                    {{> components/products/promo-products-brand products=category.products}}
                {{/if}}
            </main>

            {{{region name="category_after_products_content"}}}

            <div class="description-cont">
                {{{category.description}}}
            </div>
            {{{region name="category_after_description_content"}}}

        </div>
    </div>

{{/partial}}
{{> layout/base}}
